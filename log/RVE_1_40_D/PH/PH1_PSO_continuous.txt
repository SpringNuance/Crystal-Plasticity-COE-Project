
Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
-------------------------------------------------
| Server                        | mahti		|
| Hyperqueue                    | no		|
| Initial simulation number     | 2000		|
| Initial simulation method     | auto		|
| Searching space               | continuous	|
| Searching type                | general	|
| Material                      | RVE_1_40_D	|
| CP Law                        | PH		|
| Optimizer                     | PSO		|
| Target curves                 | PH1	|
| Stress unit                   | MPa		|
| Rounding decimals             | 5		|
| Large linear yielding dev     | 2%		|
| Small linear yielding dev     | 1%		|
| Large linear hardening dev    | 3%		|
| Small linear hardening dev    | 2%		|
| Large nonlinear yielding dev  | 3%		|
| Small nonlinear yielding dev  | 2%		|
| Large nonlinear hardening dev | 4%		|
| Small nonlinear hardening dev | 3%		|
-------------------------------------------------

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [117.886, 122.698] MPa	| [119.089, 121.495] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [227.756, 241.844] MPa	| [230.104, 239.496] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [183.409, 194.753] MPa	| [185.299, 192.863] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [172.732, 183.416] MPa	| [174.512, 181.635] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [178.653, 189.704] MPa	| [180.495, 187.862] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [157.606, 167.354] MPa	| [159.230, 165.730] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [152.356, 161.780] MPa	| [153.926, 160.209] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers    | 2		|
(PH1) | Hidden layer nodes formula | formula1	|
(PH1) | ANN Optimizer              | Adam	|
(PH1) | Learning rate              | 0.1	|
(PH1) | L2 regularization term     | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 81.80413818359375
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 200.6366424560547
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 163.28378295898438
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 162.5502166748047
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 280.843017578125
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 126.11470794677734
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 198.14561462402344
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 1%

(PH1) largeNonlinearYieldingDev = 2%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
-------------------------------------------------
| Server                        | mahti		|
| Hyperqueue                    | no		|
| Initial simulation number     | 2000		|
| Initial simulation method     | auto		|
| Searching space               | continuous	|
| Searching type                | general	|
| Material                      | RVE_1_40_D	|
| CP Law                        | PH		|
| Optimizer                     | PSO		|
| Target curves                 | PH1	|
| Stress unit                   | MPa		|
| Rounding decimals             | 5		|
| Large linear yielding dev     | 2%		|
| Small linear yielding dev     | 1%		|
| Large linear hardening dev    | 3%		|
| Small linear hardening dev    | 2%		|
| Large nonlinear yielding dev  | 3%		|
| Small nonlinear yielding dev  | 2%		|
| Large nonlinear hardening dev | 4%		|
| Small nonlinear hardening dev | 3%		|
-------------------------------------------------

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [117.886, 122.698] MPa	| [119.089, 121.495] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [227.756, 241.844] MPa	| [230.104, 239.496] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [183.409, 194.753] MPa	| [185.299, 192.863] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [172.732, 183.416] MPa	| [174.512, 181.635] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [178.653, 189.704] MPa	| [180.495, 187.862] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [157.606, 167.354] MPa	| [159.230, 165.730] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [152.356, 161.780] MPa	| [153.926, 160.209] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers    | 2		|
(PH1) | Hidden layer nodes formula | formula1	|
(PH1) | ANN Optimizer              | Adam	|
(PH1) | Learning rate              | 0.1	|
(PH1) | L2 regularization term     | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 182.04974365234375
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 263.980224609375
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 176.52783203125
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 90.89622497558594
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 140.3652801513672
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 101.18766021728516
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 184.87559509277344
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 1%

(PH1) largeNonlinearYieldingDev = 2%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
-------------------------------------------------
| Server                        | mahti		|
| Hyperqueue                    | no		|
| Initial simulation number     | 2000		|
| Initial simulation method     | auto		|
| Searching space               | continuous	|
| Searching type                | general	|
| Material                      | RVE_1_40_D	|
| CP Law                        | PH		|
| Optimizer                     | PSO		|
| Target curves                 | PH1	|
| Stress unit                   | MPa		|
| Rounding decimals             | 5		|
| Large linear yielding dev     | 2%		|
| Small linear yielding dev     | 1%		|
| Large linear hardening dev    | 3%		|
| Small linear hardening dev    | 2%		|
| Large nonlinear yielding dev  | 3%		|
| Small nonlinear yielding dev  | 2%		|
| Large nonlinear hardening dev | 4%		|
| Small nonlinear hardening dev | 3%		|
-------------------------------------------------

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [117.886, 122.698] MPa	| [119.089, 121.495] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [227.756, 241.844] MPa	| [230.104, 239.496] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [183.409, 194.753] MPa	| [185.299, 192.863] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [172.732, 183.416] MPa	| [174.512, 181.635] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [178.653, 189.704] MPa	| [180.495, 187.862] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [157.606, 167.354] MPa	| [159.230, 165.730] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [152.356, 161.780] MPa	| [153.926, 160.209] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers    | 2		|
(PH1) | Hidden layer nodes formula | formula1	|
(PH1) | ANN Optimizer              | Adam	|
(PH1) | Learning rate              | 0.1	|
(PH1) | L2 regularization term     | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 10	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 10	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 10	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 10	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 10	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 10	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 10	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 57037.1171875
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 32842.23046875
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 33186.57421875
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 21479.591796875
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 37811.90234375
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 24471.400390625
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 22452.5
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 1%

(PH1) largeNonlinearYieldingDev = 2%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
-------------------------------------------------
| Server                        | mahti		|
| Hyperqueue                    | no		|
| Initial simulation number     | 2000		|
| Initial simulation method     | auto		|
| Searching space               | continuous	|
| Searching type                | general	|
| Material                      | RVE_1_40_D	|
| CP Law                        | PH		|
| Optimizer                     | PSO		|
| Target curves                 | PH1	|
| Stress unit                   | MPa		|
| Rounding decimals             | 5		|
| Large linear yielding dev     | 2%		|
| Small linear yielding dev     | 1%		|
| Large linear hardening dev    | 3%		|
| Small linear hardening dev    | 2%		|
| Large nonlinear yielding dev  | 3%		|
| Small nonlinear yielding dev  | 2%		|
| Large nonlinear hardening dev | 4%		|
| Small nonlinear hardening dev | 3%		|
-------------------------------------------------

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [117.886, 122.698] MPa	| [119.089, 121.495] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [227.756, 241.844] MPa	| [230.104, 239.496] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [183.409, 194.753] MPa	| [185.299, 192.863] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [172.732, 183.416] MPa	| [174.512, 181.635] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [178.653, 189.704] MPa	| [180.495, 187.862] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [157.606, 167.354] MPa	| [159.230, 165.730] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [152.356, 161.780] MPa	| [153.926, 160.209] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers    | 2		|
(PH1) | Hidden layer nodes formula | formula1	|
(PH1) | ANN Optimizer              | Adam	|
(PH1) | Learning rate              | 0.1	|
(PH1) | L2 regularization term     | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 10	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 10	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 10	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 10	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 10	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 10	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 10	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 51571.24609375
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 35606.6484375
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 33544.73046875
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 22101.076171875
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 48902.9453125
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 21351.619140625
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 35632.0625
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 1%

(PH1) largeNonlinearYieldingDev = 2%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts

(PH1) #### Stage 1 ####
(PH1) #### (Curve PH1) Iteration 0 ####
(PH1) All loadings have successfully satisfied the large yielding deviation
(PH1) Succeeded iteration: 0
(PH1) The first stage parameter solution is:
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) First optimization stage finished

(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 0 ####
(PH1) All loadings have successfully satisfied the large hardening deviation
(PH1) Succeeded iteration: 0
(PH1) The third stage parameter solution is:
(PH1) ---------------------------
(PH1) | a          | 7.712857  (target)
(PH1) | h0         | 672.186093 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa (target)
(PH1) | self       | 0.581291  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) Third optimization stage finished

(PH1) **********************************************************************
(PH1) Fourth optimization stage: Optimize the small hardening parameters for the curve PH1

(PH1) #### Stage 4 ####
(PH1) Optimizing the parameters coplanar, collinear, orthogonal, glissile, sessile
(PH1) Fourth optimization stage starts

(PH1) #### Stage 4 ####
(PH1) #### (Curve PH1) Iteration 0 ####
(PH1) All loadings have successfully satisfied the small hardening deviation
(PH1) Succeeded iteration: 0
(PH1) The fourth stage parameter solution is:
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  (target)
(PH1) | collinear  | 24.887444  (target)
(PH1) | orthogonal | 0.566284  (target)
(PH1) | glissile   | 0.546274  (target)
(PH1) | sessile    | 0.654328  (target)
(PH1) ---------------------------
(PH1) Fourth optimization stage finished

(PH1) All four optimization stages have successfully completed for curve PH1
(PH1) The final optimized set of parameters is:
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------

(PH1) Optimization for curve PH1 has finished
(PH1) Waiting for other curves to finish their optimization


----------------------------------------------------------------------
Fitting parameter optimization for all target curves completed
Congratulations! Thank you for using the Crystal Plasticity Software

Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
-------------------------------------------------
| Server                        | mahti		|
| Hyperqueue                    | no		|
| Initial simulation number     | 2000		|
| Initial simulation method     | auto		|
| Searching space               | continuous	|
| Searching type                | general	|
| Material                      | RVE_1_40_D	|
| CP Law                        | PH		|
| Optimizer                     | PSO		|
| Target curves                 | PH1	|
| Stress unit                   | MPa		|
| Rounding decimals             | 5		|
| Large linear yielding dev     | 2%		|
| Small linear yielding dev     | 1%		|
| Large linear hardening dev    | 3%		|
| Small linear hardening dev    | 2%		|
| Large nonlinear yielding dev  | 3%		|
| Small nonlinear yielding dev  | 2%		|
| Large nonlinear hardening dev | 4%		|
| Small nonlinear hardening dev | 3%		|
-------------------------------------------------

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [117.886, 122.698] MPa	| [119.089, 121.495] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [227.756, 241.844] MPa	| [230.104, 239.496] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [183.409, 194.753] MPa	| [185.299, 192.863] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [172.732, 183.416] MPa	| [174.512, 181.635] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [178.653, 189.704] MPa	| [180.495, 187.862] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [157.606, 167.354] MPa	| [159.230, 165.730] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [152.356, 161.780] MPa	| [153.926, 160.209] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers    | 2		|
(PH1) | Hidden layer nodes formula | formula1	|
(PH1) | ANN Optimizer              | Adam	|
(PH1) | Learning rate              | 0.1	|
(PH1) | L2 regularization term     | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 10	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 10	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 10	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 10	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 10	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 10	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 10	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 42837.84765625
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 31467.318359375
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 76530.3984375
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 25580.373046875
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 32714.81640625
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 20773.54296875
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 22748.44921875
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 1%

(PH1) largeNonlinearYieldingDev = 2%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) The file stage3_curves.npy detected, which means the third stage has finished
(PH1) Third optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  (target)
(PH1) | h0         | 672.186093 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa (target)
(PH1) | self       | 0.581291  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Fourth optimization stage: Optimize the small hardening parameters for the curve PH1

(PH1) #### Stage 4 ####
(PH1) The file stage4_curves.npy detected, which means the fourth stage has finished
(PH1) Fourth optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  (target)
(PH1) | collinear  | 24.887444  (target)
(PH1) | orthogonal | 0.566284  (target)
(PH1) | glissile   | 0.546274  (target)
(PH1) | sessile    | 0.654328  (target)
(PH1) ---------------------------
(PH1) All four optimization stages have successfully completed for curve PH1
(PH1) The final optimized set of parameters is:
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------

(PH1) Optimization for curve PH1 has finished
(PH1) Waiting for other curves to finish their optimization


======================================================================
Fitting parameter optimization for all target curves completed
Congratulations! Thank you for using the Crystal Plasticity Software

Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
-------------------------------------------------
| Server                        | mahti		|
| Hyperqueue                    | no		|
| Initial simulation number     | 2000		|
| Initial simulation method     | auto		|
| Searching space               | continuous	|
| Searching type                | general	|
| Material                      | RVE_1_40_D	|
| CP Law                        | PH		|
| Optimizer                     | PSO		|
| Target curves                 | PH1	|
| Stress unit                   | MPa		|
| Rounding decimals             | 5		|
| Large linear yielding dev     | 2%		|
| Small linear yielding dev     | 1%		|
| Large linear hardening dev    | 3%		|
| Small linear hardening dev    | 2%		|
| Large nonlinear yielding dev  | 3%		|
| Small nonlinear yielding dev  | 2%		|
| Large nonlinear hardening dev | 4%		|
| Small nonlinear hardening dev | 3%		|
-------------------------------------------------

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [117.886, 122.698] MPa	| [119.089, 121.495] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [227.756, 241.844] MPa	| [230.104, 239.496] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [183.409, 194.753] MPa	| [185.299, 192.863] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [172.732, 183.416] MPa	| [174.512, 181.635] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [178.653, 189.704] MPa	| [180.495, 187.862] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [157.606, 167.354] MPa	| [159.230, 165.730] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [152.356, 161.780] MPa	| [153.926, 160.209] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers            | 2		|
(PH1) | Hidden layer nodes formula         | formula1	|
(PH1) | ANN Optimizer                      | Adam	|
(PH1) | Learning rate                      | 0.1	|
(PH1) | L2 regularization term             | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 104.36338806152344
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 125.20953369140625
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 281.386962890625
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 121.98331451416016
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 237.45101928710938
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 180.82127380371094
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 126.08980560302734
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 1%

(PH1) largeNonlinearYieldingDev = 2%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts

(PH1) #### Stage 1 ####
(PH1) #### (Curve PH1) Iteration 0 ####
(PH1) All loadings have successfully satisfied the deviation percentage
(PH1) Succeeded iteration: 0
(PH1) The first stage parameter solution is:
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) First optimization stage finished

(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 8.91764  (target)
(PH1) | h0         | 519.45953 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 438.50908 MPa (target)
(PH1) | self       | 0.73298  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 47.82174694916764

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [119.089, 121.495] MPa	| [119.690, 120.893] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [231.278, 238.322] MPa	| [232.452, 237.148] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [186.245, 191.917] MPa	| [187.190, 190.972] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [175.403, 180.745] MPa	| [176.293, 179.855] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [181.416, 186.941] MPa	| [182.337, 186.020] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [160.043, 164.917] MPa	| [160.855, 164.105] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [154.712, 159.424] MPa	| [155.497, 158.638] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | Loading		         | Exp σ_yield  | Large σ_yield sim range	| Small σ_yield sim range	|
(PH1) -----------------------------------------------------------------------------------------------------------
(PH1) | linear_uniaxial_RD       | 120.292 MPa	| [119.089, 121.495] MPa	| [119.690, 120.893] MPa	|
(PH1) | nonlinear_biaxial_RD     | 234.800 MPa	| [231.278, 238.322] MPa	| [232.452, 237.148] MPa	|
(PH1) | nonlinear_biaxial_TD     | 189.081 MPa	| [186.245, 191.917] MPa	| [187.190, 190.972] MPa	|
(PH1) | nonlinear_planestrain_RD | 178.074 MPa	| [175.403, 180.745] MPa	| [176.293, 179.855] MPa	|
(PH1) | nonlinear_planestrain_TD | 184.178 MPa	| [181.416, 186.941] MPa	| [182.337, 186.020] MPa	|
(PH1) | nonlinear_uniaxial_RD    | 162.480 MPa	| [160.043, 164.917] MPa	| [160.855, 164.105] MPa	|
(PH1) | nonlinear_uniaxial_TD    | 157.068 MPa	| [154.712, 159.424] MPa	| [155.497, 158.638] MPa	|
(PH1) -----------------------------------------------------------------------------------------------------------

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers            | 2		|
(PH1) | Hidden layer nodes formula         | formula1	|
(PH1) | ANN Optimizer                      | Adam	|
(PH1) | Learning rate                      | 0.1	|
(PH1) | L2 regularization term             | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 109.66397094726562
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 169.21484375
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 151.575927734375
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 121.64228057861328
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 220.58493041992188
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 118.80734252929688
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 156.36575317382812
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 9.62454  (target)
(PH1) | h0         | 1348.93582 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 337.1907 MPa (target)
(PH1) | self       | 0.74441  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 224.5945468738474

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
(PH1) +--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+(PH1) 

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers            | 2		|
(PH1) | Hidden layer nodes formula         | formula1	|
(PH1) | ANN Optimizer                      | Adam	|
(PH1) | Learning rate                      | 0.1	|
(PH1) | L2 regularization term             | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 162.30831909179688
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 216.19395446777344
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 167.07151794433594
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 165.32485961914062
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 270.1160888671875
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 137.9621124267578
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 151.07823181152344
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 8.7164  (target)
(PH1) | h0         | 610.70823 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 426.14086 MPa (target)
(PH1) | self       | 1.37223  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 284.5060248140476

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
(PH1) ---------------------------
(PH1) | a          | 7.712857 
(PH1) | h0         | 672.186093 MPa
(PH1) | tau0       | 48.385693 MPa
(PH1) | tausat     | 385.307654 MPa
(PH1) | self       | 0.581291 
(PH1) | coplanar   | 1.103552 
(PH1) | collinear  | 24.887444 
(PH1) | orthogonal | 0.566284 
(PH1) | glissile   | 0.546274 
(PH1) | sessile    | 0.654328 
(PH1) ---------------------------
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers            | 2		|
(PH1) | Hidden layer nodes formula         | formula1	|
(PH1) | ANN Optimizer                      | Adam	|
(PH1) | Learning rate                      | 0.1	|
(PH1) | L2 regularization term             | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 119.28079986572266
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 171.91549682617188
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 220.013916015625
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 238.74652099609375
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 153.2371368408203
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 123.90654754638672
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 147.13735961914062
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 9.89786  (target)
(PH1) | h0         | 1314.914 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 320.20547 MPa (target)
(PH1) | self       | 1.71634  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 279.6122660435528

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
| a          |   7.712857     |
|            |                |
| h0         | 672.186093 MPa |
|            |                |
| tau0       | 48.385693 MPa  |
|            |                |
| tausat     | 385.307654 MPa |
|            |                |
| self       |   0.581291     |
|            |                |
| coplanar   |   1.103552     |
|            |                |
| collinear  |   24.887444    |
|            |                |
| orthogonal |   0.566284     |
|            |                |
| glissile   |   0.546274     |
|            |                |
| sessile    |   0.654328     |
|            |                |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers            | 2		|
(PH1) | Hidden layer nodes formula         | formula1	|
(PH1) | ANN Optimizer                      | Adam	|
(PH1) | Learning rate                      | 0.1	|
(PH1) | L2 regularization term             | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 87.8050765991211
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 168.77145385742188
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 223.26974487304688
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 220.8345489501953
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 258.9964904785156
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 97.08973693847656
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 137.32691955566406
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 3.81997  (target)
(PH1) | h0         | 336.52087 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 441.21005 MPa (target)
(PH1) | self       | 0.42684  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 292.95303479033754

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|            |                |
|     h0     | 672.186093 MPa |
|            |                |
|    tau0    | 48.385693 MPa  |
|            |                |
|   tausat   | 385.307654 MPa |
|            |                |
|    self    |   0.581291     |
|            |                |
|  coplanar  |   1.103552     |
|            |                |
| collinear  |   24.887444    |
|            |                |
| orthogonal |   0.566284     |
|            |                |
|  glissile  |   0.546274     |
|            |                |
|  sessile   |   0.654328     |
|            |                |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |   0.581291     |
|  coplanar  |   1.103552     |
| collinear  |   24.887444    |
| orthogonal |   0.566284     |
|  glissile  |   0.546274     |
|  sessile   |   0.654328     |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
(PH1) -------------------------------------------
(PH1) | Number of hidden layers            | 2		|
(PH1) | Hidden layer nodes formula         | formula1	|
(PH1) | ANN Optimizer                      | Adam	|
(PH1) | Learning rate                      | 0.1	|
(PH1) | L2 regularization term             | 0.5	|
(PH1) | Epochs of linear_uniaxial_RD        | 2200	|
(PH1) | Epochs of nonlinear_biaxial_RD      | 3200	|
(PH1) | Epochs of nonlinear_biaxial_TD      | 2200	|
(PH1) | Epochs of nonlinear_planestrain_RD  | 3600	|
(PH1) | Epochs of nonlinear_planestrain_TD  | 3000	|
(PH1) | Epochs of nonlinear_uniaxial_RD     | 3400	|
(PH1) | Epochs of nonlinear_uniaxial_TD     | 2000	|
(PH1) -------------------------------------------

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 116.78693389892578
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 352.7859191894531
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 213.36297607421875
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 258.4501953125
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 156.12535095214844
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 133.78878784179688
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 152.43600463867188
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 9.36546  (target)
(PH1) | h0         | 238.86236 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 625.41518 MPa (target)
(PH1) | self       | 1.75409  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 187.10607344957526

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |   0.581291     |
|  coplanar  |   1.103552     |
| collinear  |   24.887444    |
| orthogonal |   0.566284     |
|  glissile  |   0.546274     |
|  sessile   |   0.654328     |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:

+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 129.80233764648438
(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 136.74606323242188
(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 306.6605224609375
(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 142.02935791015625
(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 233.11927795410156
(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 131.2838897705078
(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 104.05671691894531
(PH1) The number of combined interpolate curves is 500

(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 6.0866  (target)
(PH1) | h0         | 1252.44737 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 229.78495 MPa (target)
(PH1) | self       | 1.05993  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 293.4396685391134

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |   0.581291     |
|  coplanar  |   1.103552     |
| collinear  |   24.887444    |
| orthogonal |   0.566284     |
|  glissile  |   0.546274     |
|  sessile   |   0.654328     |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 143.12234497070312

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 174.87783813476562

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 275.00396728515625

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 177.9656524658203

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 191.28875732421875

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 145.2220458984375

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 148.99374389648438

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa (target)
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
(PH1) ---------------------------
(PH1) | a          | 7.712857  
(PH1) | h0         | 672.186093 MPa 
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 385.307654 MPa 
(PH1) | self       | 0.581291  
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 8.78  (target)
(PH1) | h0         | 116.3529 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 608.55806 MPa (target)
(PH1) | self       | 1.30253  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 272.8912194174714

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |   0.581291     |
|  coplanar  |   1.103552     |
| collinear  |   24.887444    |
| orthogonal |   0.566284     |
|  glissile  |   0.546274     |
|  sessile   |   0.654328     |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 109.93681335449219

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 253.16409301757812

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 219.81483459472656

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 137.15298461914062

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 188.2100067138672

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 96.38208770751953

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 196.04913330078125

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) The current result parameters
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |       7.712857         |
|     h0     |    672.186093 MPa      |
|    tau0    | 48.385693 MPa (target) |
|   tausat   |    385.307654 MPa      |
|    self    |       0.581291         |
|  coplanar  |       1.103552         |
| collinear  |      24.887444         |
| orthogonal |       0.566284         |
|  glissile  |       0.546274         |
|  sessile   |       0.654328         |
+------------+------------------------+
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
+------------+-----------------+
| Parameter  |      Value      |
+------------+-----------------+
|     a      |    7.712857     |
|     h0     | 672.186093 MPa  |
|    tau0    |  48.385693 MPa  |
|   tausat   | 385.307654 MPa  |
|    self    |    0.581291     |
|  coplanar  |    1.103552     |
| collinear  |   24.887444     |
| orthogonal |    0.566284     |
|  glissile  |    0.546274     |
|  sessile   |    0.654328     |
+------------+-----------------+
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 8.2804  (target)
(PH1) | h0         | 1676.82729 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 277.09675 MPa (target)
(PH1) | self       | 1.16343  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 280.85408748166225

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  | Value          |
+------------+----------------+
|     a      | 7.712857       |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    | 0.581291       |
|  coplanar  | 1.103552       |
| collinear  | 24.887444      |
| orthogonal | 0.566284       |
|  glissile  | 0.546274       |
|  sessile   | 0.654328       |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 138.1183319091797

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 172.94210815429688

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 161.02780151367188

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 125.38382720947266

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 153.21865844726562

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 147.59921264648438

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 237.58143615722656

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) The current result parameters
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |       7.712857         |
|     h0     |    672.186093 MPa      |
|    tau0    | 48.385693 MPa (target) |
|   tausat   |    385.307654 MPa      |
|    self    |       0.581291         |
|  coplanar  |       1.103552         |
| collinear  |      24.887444         |
| orthogonal |       0.566284         |
|  glissile  |       0.546274         |
|  sessile   |       0.654328         |
+------------+------------------------+
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
+------------+-----------------+
| Parameter  |      Value      |
+------------+-----------------+
|     a      |    7.712857     |
|     h0     | 672.186093 MPa  |
|    tau0    |  48.385693 MPa  |
|   tausat   | 385.307654 MPa  |
|    self    |    0.581291     |
|  coplanar  |    1.103552     |
| collinear  |   24.887444     |
| orthogonal |    0.566284     |
|  glissile  |    0.546274     |
|  sessile   |    0.654328     |
+------------+-----------------+
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
(PH1) ---------------------------
(PH1) | a          | 2.89404  (target)
(PH1) | h0         | 288.52139 MPa (target)
(PH1) | tau0       | 48.385693 MPa 
(PH1) | tausat     | 403.98703 MPa (target)
(PH1) | self       | 1.41838  (target)
(PH1) | coplanar   | 1.103552  
(PH1) | collinear  | 24.887444  
(PH1) | orthogonal | 0.566284  
(PH1) | glissile   | 0.546274  
(PH1) | sessile    | 0.654328  
(PH1) ---------------------------
(PH1) This is new parameters. Fitness value of the best candidate parameters: 250.15861667692448

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |   0.581291     |
|  coplanar  |   1.103552     |
| collinear  |   24.887444    |
| orthogonal |   0.566284     |
|  glissile  |   0.546274     |
|  sessile   |   0.654328     |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 127.28827667236328

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 351.3186340332031

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 179.26675415039062

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 138.3334503173828

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 175.9609375

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 127.31314849853516

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 166.9624786376953

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) The current result parameters
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |       7.712857         |
|     h0     |    672.186093 MPa      |
|    tau0    | 48.385693 MPa (target) |
|   tausat   |    385.307654 MPa      |
|    self    |       0.581291         |
|  coplanar  |       1.103552         |
| collinear  |      24.887444         |
| orthogonal |       0.566284         |
|  glissile  |       0.546274         |
|  sessile   |       0.654328         |
+------------+------------------------+
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
+------------+-----------------+
| Parameter  |      Value      |
+------------+-----------------+
|     a      |    7.712857     |
|     h0     | 672.186093 MPa  |
|    tau0    |  48.385693 MPa  |
|   tausat   | 385.307654 MPa  |
|    self    |    0.581291     |
|  coplanar  |    1.103552     |
| collinear  |   24.887444     |
| orthogonal |    0.566284     |
|  glissile  |    0.546274     |
|  sessile   |    0.654328     |
+------------+-----------------+
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |   7.57484  (target)    |
|     h0     | 543.23375 MPa (target) |
|    tau0    |     48.385693 MPa      |
|   tausat   | 396.7384 MPa (target)  |
|    self    |   1.42687  (target)    |
|  coplanar  |       1.103552         |
| collinear  |      24.887444         |
| orthogonal |       0.566284         |
|  glissile  |       0.546274         |
|  sessile   |       0.654328         |
+------------+------------------------+
(PH1) This is new parameters. Fitness value of the best candidate parameters: 448.2517217484186

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |   7.712857     |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |   0.581291     |
|  coplanar  |   1.103552     |
| collinear  |   24.887444    |
| orthogonal |   0.566284     |
|  glissile  |   0.546274     |
|  sessile   |   0.654328     |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 166.55882263183594

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 126.51127624511719

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 340.6216125488281

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 163.97592163085938

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 184.38002014160156

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 130.61102294921875

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 119.37832641601562

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) The file stage1_curves.npy detected, which means the first stage has finished
(PH1) First optimization stage finished

(PH1) The current result parameters
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |       7.712857         |
|     h0     |    672.186093 MPa      |
|    tau0    | 48.385693 MPa (target) |
|   tausat   |    385.307654 MPa      |
|    self    |       0.581291         |
|  coplanar  |       1.103552         |
| collinear  |      24.887444         |
| orthogonal |       0.566284         |
|  glissile  |       0.546274         |
|  sessile   |       0.654328         |
+------------+------------------------+
(PH1) **********************************************************************
(PH1) Second optimization stage: Optimize the small yielding parameters for the curve PH1

(PH1) #### Stage 2 ####
(PH1) There are no small yielding parameters to optimize
(PH1) Saving second stage result curves as the default curves
(PH1) Second optimization stage finished

(PH1) The current result parameters
+------------+-----------------+
| Parameter  |      Value      |
+------------+-----------------+
|     a      |    7.712857     |
|     h0     | 672.186093 MPa  |
|    tau0    |  48.385693 MPa  |
|   tausat   | 385.307654 MPa  |
|    self    |    0.581291     |
|  coplanar  |    1.103552     |
| collinear  |   24.887444     |
| orthogonal |    0.566284     |
|  glissile  |    0.546274     |
|  sessile   |    0.654328     |
+------------+-----------------+
(PH1) **********************************************************************
(PH1) Third optimization stage: Optimize the large hardening parameters for the curve PH1

(PH1) #### Stage 3 ####
(PH1) Optimizing the parameters a, h0, tausat, self
(PH1) Third optimization stage starts

(PH1) #### Stage 3 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH1) #### Stage 3 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |    7.6433 (target)    |
|     h0     | 927.6908 MPa (target) |
|    tau0    |     48.385693 MPa     |
|   tausat   | 313.4446 MPa (target) |
|    self    |    1.38438 (target)   |
|  coplanar  |        1.103552       |
| collinear  |       24.887444       |
| orthogonal |        0.566284       |
|  glissile  |        0.546274       |
|  sessile   |        0.654328       |
+------------+-----------------------+
(PH1) This is new parameters. Fitness value of the best candidate parameters: 334.7627782198765

(PH1) #### Stage 3 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|       Experimental types      |      D      |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|       Experimental types      |      D      |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|       Experimental types      |      D      |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa  |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa  |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa  |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa  |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa  |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa  |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa  |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.712857    |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |    0.581291    |
|  coplanar  |    1.103552    |
| collinear  |   24.887444    |
| orthogonal |    0.566284    |
|  glissile  |    0.546274    |
|  sessile   |    0.654328    |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 176.9545440673828

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 168.0522003173828

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 206.6151123046875

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 144.33421325683594

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 148.1222686767578

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 183.6346893310547

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 226.40017700195312

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts

(PH1) #### Stage 1 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD

(PH1) #### Stage 1 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        7.712857       |
|     h0     |     672.186093 MPa    |
|    tau0    | 48.66752 MPa (target) |
|   tausat   |     385.307654 MPa    |
|    self    |        0.581291       |
|  coplanar  |        1.103552       |
| collinear  |       24.887444       |
| orthogonal |        0.566284       |
|  glissile  |        0.546274       |
|  sessile   |        0.654328       |
+------------+-----------------------+
(PH1) This is new parameters. Fitness value of the best candidate parameters: 157.0467159490877

(PH1) #### Stage 1 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|       Experimental types      |      D      |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa] |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa] |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa] |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa] |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa] |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa] |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.712857    |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |    0.581291    |
|  coplanar  |    1.103552    |
| collinear  |   24.887444    |
| orthogonal |    0.566284    |
|  glissile  |    0.546274    |
|  sessile   |    0.654328    |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 151.2738494873047

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 254.79022216796875

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 238.74681091308594

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 176.32594299316406

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 176.37644958496094

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 90.40606689453125

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 212.61251831054688

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts

(PH1) #### Stage 1 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD

(PH1) #### Stage 1 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        7.712857       |
|     h0     |     672.186093 MPa    |
|    tau0    | 50.84574 MPa (target) |
|   tausat   |     385.307654 MPa    |
|    self    |        0.581291       |
|  coplanar  |        1.103552       |
| collinear  |       24.887444       |
| orthogonal |        0.566284       |
|  glissile  |        0.546274       |
|  sessile   |        0.654328       |
+------------+-----------------------+
(PH1) This is new parameters. Fitness value of the best candidate parameters: 200.9723547344815

(PH1) #### Stage 1 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|       Experimental types      |      D      |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa] |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa] |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa] |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa] |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa] |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa] |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.712857    |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |    0.581291    |
|  coplanar  |    1.103552    |
| collinear  |   24.887444    |
| orthogonal |    0.566284    |
|  glissile  |    0.546274    |
|  sessile   |    0.654328    |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 139.16482543945312

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 181.89572143554688

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 167.65101623535156

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 201.81341552734375

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 167.16041564941406

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 145.1077423095703

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 187.26364135742188

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts

(PH1) #### Stage 1 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD

(PH1) #### Stage 1 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       7.712857       |
|     h0     |    672.186093 MPa    |
|    tau0    | 46.3357 MPa (target) |
|   tausat   |    385.307654 MPa    |
|    self    |       0.581291       |
|  coplanar  |       1.103552       |
| collinear  |      24.887444       |
| orthogonal |       0.566284       |
|  glissile  |       0.546274       |
|  sessile   |       0.654328       |
+------------+----------------------+
(PH1) This is new parameters. Fitness value of the best candidate parameters: 102.28889047697311

(PH1) #### Stage 1 ####
(PH1) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH1     |
|       Experimental types      |      D      |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/home/springnuance/Desktop/Crystal-Plasticity-COE-Course

PyTorch version: 1.13.0+cpu
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH1) **********************************************************************
(PH1) Step 1: Loading progress and preparing data for curve PH1

(PH1) Curve PH1 status: 
(PH1) 500 initial simulations completed.
(PH1) No additional iteration simulations completed.
(PH1) Saving interpolating PH1 target curves
(PH1) Saving initial interpolating curves and reverse initial interpolating curves
(PH1) Experimental and simulated curves preparation completed

(PH1) Curve PH1 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 120.292 MPa  |  [119.089, 121.495] MPa |  [119.690, 120.893 MPa] |
|   nonlinear_biaxial_RD   | 234.800 MPa  |  [231.278, 238.322] MPa |  [232.452, 237.148 MPa] |
|   nonlinear_biaxial_TD   | 189.081 MPa  |  [186.245, 191.917] MPa |  [187.190, 190.972 MPa] |
| nonlinear_planestrain_RD | 178.074 MPa  |  [175.403, 180.745] MPa |  [176.293, 179.855 MPa] |
| nonlinear_planestrain_TD | 184.178 MPa  |  [181.416, 186.941] MPa |  [182.337, 186.020 MPa] |
|  nonlinear_uniaxial_RD   | 162.480 MPa  |  [160.043, 164.917] MPa |  [160.855, 164.105 MPa] |
|  nonlinear_uniaxial_TD   | 157.068 MPa  |  [154.712, 159.424] MPa |  [155.497, 158.638 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH1) Parameter set of the closest simulation curve to the target curve PH1 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.712857    |
|     h0     | 672.186093 MPa |
|    tau0    | 48.385693 MPa  |
|   tausat   | 385.307654 MPa |
|    self    |    0.581291    |
|  coplanar  |    1.103552    |
| collinear  |   24.887444    |
| orthogonal |    0.566284    |
|  glissile  |    0.546274    |
|  sessile   |    0.654328    |
+------------+----------------+
(PH1) Saving the default curves
(PH1) This parameter set will serve as default parameters for the 4 stage optimization of curve PH1

(PH1) **********************************************************************
(PH1) Step 2: Train the regressors for all loadings with the initial simulations of curve PH1

(PH1) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH1) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH1) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (linear_uniaxial_RD) stressLabels shape is (500, 32)
(PH1) Finish training ANN for loading linear_uniaxial_RD
(PH1) Training MSE error: 130.86598205566406

(PH1) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_RD
(PH1) Training MSE error: 179.7956085205078

(PH1) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_biaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_biaxial_TD
(PH1) Training MSE error: 131.66802978515625

(PH1) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_RD
(PH1) Training MSE error: 134.58116149902344

(PH1) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_planestrain_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_planestrain_TD
(PH1) Training MSE error: 151.0758819580078

(PH1) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_RD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_RD
(PH1) Training MSE error: 132.8228302001953

(PH1) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH1) (nonlinear_uniaxial_TD) stressLabels shape is (500, 22)
(PH1) Finish training ANN for loading nonlinear_uniaxial_TD
(PH1) Training MSE error: 214.14736938476562

(PH1) The number of combined interpolate curves is 500
(PH1) Finish training ANN for all loadings of curve PH1

(PH1) **********************************************************************
(PH1) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH1

(PH1) The large yielding parameters are ['tau0']
(PH1) The small yielding parameters are []
(PH1) The large hardening parameters are ['a', 'h0', 'tausat', 'self']
(PH1) The small hardening parameters are ['coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH1) There are 1 large yielding parameters
(PH1) 1st stage optimization required
(PH1) There are no small yielding parameters
(PH1) 2nd stage optimization not required
(PH1) There are 4 large hardening parameters
(PH1) 3rd stage optimization required
(PH1) There are 5 small hardening parameters
(PH1) 4th stage optimization required

(PH1) Because there are no small yielding parameters but there are large yielding parameters
(PH1) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH1) largeLinearYieldingDev = 0.5%

(PH1) largeNonlinearYieldingDev = 1%

(PH1) The chosen optimizer is Particle Swarm Optimization
(PH1) Starting the four stage optimization for curve PH1

(PH1) **********************************************************************
(PH1) First optimization stage: Optimize the large yielding parameters for the curve PH1

(PH1) #### Stage 1 ####
(PH1) Optimizing the parameters tau0
(PH1) First optimization stage starts

(PH1) #### Stage 1 ####
(PH1) The loadings not satisfied are
linear_uniaxial_RD

(PH1) #### Stage 1 ####
(PH1) #### (Curve PH1) Iteration 1 ####
(PH1) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        7.712857       |
|     h0     |     672.186093 MPa    |
|    tau0    | 50.22796 MPa (target) |
|   tausat   |     385.307654 MPa    |
|    self    |        0.581291       |
|  coplanar  |        1.103552       |
| collinear  |       24.887444       |
| orthogonal |        0.566284       |
|  glissile  |        0.546274       |
|  sessile   |        0.654328       |
+------------+-----------------------+
(PH1) This is new parameters. Fitness value of the best candidate parameters: 51.23822819453662

(PH1) #### Stage 1 ####
(PH1) Running iteration 1 simulation

